

Connect-AzureAD -TenantId 469e5440-f229-44f8-bed2-c32cdd34d90a

 Authentication : Single Page application (Url of application, for now you can add any random string for testing powershell script)
 Api Permissions
Delegated : email, offline_access, openid, profile, User.Read
Application : User.Read.All

#Application- Role
#Delegated - Scope
--------------------------------------------------------------
New-AzADApplication -DisplayName "APIName" -SPARedirectUri "http://localhost.com"

Get-AzAdServicePrincipal -ApplicationId e64df0dd-7c8b-42f2-85df-45a31753a74e

$MicrosoftGraphAppId = '00000003-0000-0000-c000-000000000000'

Add-AzADAppPermission -ObjectId 80db4948-9106-46de-a2f4-cc22a8b695e4 -ApiId $MicrosoftGraphAppId -PermissionId e1fe6dd8-ba31-4d61-89e7-88639da4683d

User.Read - e1fe6dd8-ba31-4d61-89e7-88639da4683d
profile - 14dad69e-099b-42c9-810b-d002981feec1
openid - 37f7f235-527c-4136-accd-4a02d197296e
offline_access - 7427e0e9-2fba-42fe-b0c0-848c9e6a8182
email - 64a6cdd6-aab1-4aaf-94b8-3cc8405e90d0
User.Read.All - df021288-bdef-4463-88db-98f22de89214

-------Adding multiple API permissions---------------
$PermissionId = @(
    "e1fe6dd8-ba31-4d61-89e7-88639da4683d",
    "14dad69e-099b-42c9-810b-d002981feec1",
    "37f7f235-527c-4136-accd-4a02d197296e",
    "7427e0e9-2fba-42fe-b0c0-848c9e6a8182",
    "64a6cdd6-aab1-4aaf-94b8-3cc8405e90d0",
    "df021288-bdef-4463-88db-98f22de89214"
)
foreach($id in $PermissionId){
    Write-Host $id
    Add-AzADAppPermission -ObjectId c840859f-325a-4caa-9904-8450c1b1c63c -ApiId $MicrosoftGraphAppId -PermissionId $id
}





  